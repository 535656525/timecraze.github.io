{% extends 'base.html' %}

{% block title %}My Profile | Timecraze{% endblock %}

{% block head %}
  <style>
    .profile-container{padding:120px 8% 60px;max-width:1200px;margin:0 auto}
    .profile-grid{display:grid;grid-template-columns:1.2fr 1fr;gap:1.25rem;align-items:flex-start}
    @media(max-width:992px){.profile-grid{grid-template-columns:1fr}}
    .profile-card{background:#1e1e1e;border:1px solid #333;border-radius:14px;padding:1.25rem}
    .profile-title{color:#fff;font-weight:500;margin-bottom:1rem}
    .profile-card h2{color:#fff;font-weight:600;margin-bottom:.6rem}
    .profile-label{display:block;color:#a0a0a0;font-size:.9rem;margin-bottom:.35rem}
    .profile-input{display:block;width:100%;padding:.9rem;border-radius:12px;border:1px solid #333;background:#181818;color:#e0e0e0;margin:.25rem 0 .75rem 0;box-sizing:border-box}
    .profile-row{display:grid;grid-template-columns:1fr 1fr;gap:1rem}
    @media(max-width:600px){.profile-row{grid-template-columns:1fr}}
    .btn{border:none;border-radius:999px;padding:.9rem 1.4rem;font-weight:600;cursor:pointer;transition:all .25s}
    .btn-primary{background:#d4af37;color:#121212}
    .btn-primary:hover{background:#b8941f;transform:translateY(-2px)}
    .btn-secondary{background:transparent;color:#fff;border:1px solid #fff;text-decoration:none;display:inline-block}
    .muted{color:#a0a0a0}
  </style>
{% endblock %}

{% block content %}
  <div class="profile-container">
    <h1 class="profile-title">My Profile</h1>
    <div class="profile-grid">
      
      <!-- Account Info (read-only) -->
      <div class="profile-card">
        <h2>Account</h2>
        <form method="POST" enctype="multipart/form-data">
          <div style="display:flex;align-items:center;gap:1.25rem;margin-bottom:1rem;flex-wrap:wrap;">
            <div style="width:64px;height:64px;border-radius:50%;overflow:hidden;background:#333;display:flex;align-items:center;justify-content:center;font-weight:600;color:#fff;font-size:1.1rem;">
              {% if user.avatar_url %}
                <img src="{{ user.avatar_url }}" alt="Avatar" style="width:100%;height:100%;object-fit:cover;">
              {% else %}
                {{ user.name[:1] if user.name }}
              {% endif %}
            </div>
            <div>
              <label class="profile-label">Profile Photo</label>
              <input type="file" name="avatar" accept="image/*" class="profile-input" style="padding:.5rem;background:transparent;border-style:dashed;">
              <button type="submit" name="save_avatar" class="btn btn-primary" style="margin-top:.5rem;">Upload Photo</button>
            </div>
          </div>
        <div class="profile-row">
          <div>
            <label class="profile-label">Name</label>
            <div class="profile-input" style="border:none;padding-left:0;background:transparent;cursor:default;">{{ user.name }}</div>
          </div>
          <div>
            <label class="profile-label">Email</label>
            <div class="profile-input" style="border:none;padding-left:0;background:transparent;cursor:default;">{{ user.email }}</div>
          </div>
        </div>
        <div style="margin-top:1rem;display:flex;gap:.6rem;flex-wrap:wrap;">
          <a href="{{ url_for('auth.logout') }}" class="btn btn-secondary">Logout</a>
        </div>
        </form>
      </div>

      <!-- Address Info -->
      <div class="profile-card">
        <h2>Default Shipping Address</h2>
        <form method="POST">
          <div>
            <label class="profile-label">Address</label>
            <input type="text" name="address" value="{{ user.address.address if user.address else '' }}" class="profile-input">
          </div>
          <div class="profile-row" style="margin-top:.6rem">
            <div>
              <label class="profile-label">City</label>
              <input type="text" name="city" value="{{ user.address.city if user.address else '' }}" class="profile-input">
            </div>
            <div>
              <label class="profile-label">State</label>
              <input type="text" name="state" value="{{ user.address.state if user.address else '' }}" class="profile-input">
            </div>
          </div>
          <div class="profile-row" style="margin-top:.6rem">
            <div>
              <label class="profile-label">Pincode</label>
              <input type="text" name="zip" value="{{ user.address.zip if user.address else '' }}" class="profile-input">
            </div>
            <div>
              <label class="profile-label">Country</label>
              <input type="text" name="country" value="{{ user.address.country if user.address else '' }}" class="profile-input">
            </div>
          </div>
          <div style="margin-top:1rem">
            <button type="submit" name="save_address" class="btn btn-primary">Save Address</button>
          </div>
          <p class="muted" style="margin-top:.6rem">Saved address will prefill on Checkout.</p>
        </form>
      </div>

    </div>
  </div>
{% endblock %}

{% block scripts %}{% endblock %}

